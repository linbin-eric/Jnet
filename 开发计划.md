# 目标

1. 创建HttpConnection2，用来实现对客户端请求 Http 的包装。

## 核心思路

1. 采用 HttpResponsePartDecoder 作为响应的解析器。
2. HttpConnection2 中需要有 write 方法，该方法的入参是HttpSendRequest和超时参数，响应是HttpCompleteResponse。该响应包含了完整的头部和 body，其中 body 只包含有效内容，也就是说，如果响应采用了 chunked 编码，则 body 的内容是各个 chunk 的 body 部分组合在一起。
3. HttpConnection2创建一个 ResponseFuture 对象作为属性，在 write 方法的内部，首先是创建 ResponseFuture 对象，赋值给该属性。该属性采用volatile修饰。
4. ResponseFuture 是一个接口，有聚合（Aggregator）与流式 （Streamable）两种实现。ResponseFuture 有一个方法是 onReceive（HttpResponsePart）
5. HttpConnection2 的 write 方法有两个版本，一个是带超时参数，返回AggregatorHttpResponse；一个不带超时参数，返回StreamableHttpResponse。
   1. 带超时参数版本，创建AggregatorHttpResponse 对象，赋值给ResponseFuture 属性。在这个对象上调用方法 waitForEnd，执行超时等待。
   2. 不带超时参数的版本，创建StreamableHttpResponse 对象。赋值给ResponseFuture 属性。

6. 
